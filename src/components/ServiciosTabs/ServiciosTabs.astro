---
import './ServiciosTabs.css';

const services = [
  {
    id: 'team-growth',
    title: 'Team Growth',
    description:
      'Refuerza tu equipo con talento a medida. Selección ágil y precisa para acelerar tus proyectos sin fricción.',
  },
  {
    id: 'in-house',
    title: 'In‑House',
    description:
      'Incorpora perfiles clave dentro de tu organización con un proceso simple, transparente y muy humano.',
  },
  {
    id: 'advisors',
    title: 'Advisor Matching',
    description:
      'Conecta con expertos senior que te ayuden a tomar mejores decisiones de producto, diseño y tecnología.',
  },
  {
    id: 'executive',
    title: 'Executive Search',
    description:
      'Búsqueda directiva discreta y eficiente. Encontramos líderes que encajan con tu cultura y objetivos.',
  },
];
---

<section class="servicios-tabs-section">
  <div class="container">
    <div class="servicios-tabs-header">
      <span class="section-pill">Nuestros Servicios</span>
      <h2 class="section-title">Soluciones para cada etapa</h2>
    </div>

    <div class="tabs">
      {services.map((s, index) => (
        <button class={`tab ${index === 0 ? 'active' : ''}`} data-tab={s.id}>{s.title}</button>
      ))}
    </div>

    <div class="panel">
      <div class="panel-grid">
        <div class="panel-media">
          <img src="/images/placeholder.jpg" alt="Servicio" class="panel-img" loading="lazy" />
        </div>
        <div class="panel-content">
          <h3 class="panel-title">{services[0].title}</h3>
          <p class="panel-description">{services[0].description}</p>
          <a href="#" class="panel-cta">Saber más</a>
        </div>
      </div>
    </div>
  </div>

  <script define:vars={{ services }}>
    const tabs = Array.from(document.querySelectorAll('.servicios-tabs-section .tab'));
    const titleEl = document.querySelector('.servicios-tabs-section .panel-title');
    const descEl = document.querySelector('.servicios-tabs-section .panel-description');
    const content = document.querySelector('.servicios-tabs-section .panel-content');
    const media = document.querySelector('.servicios-tabs-section .panel-media');

    function setActive(id) {
      tabs.forEach(t => t.classList.toggle('active', t.getAttribute('data-tab') === id));
      const svc = services.find(s => s.id === id);
      if (!svc) return;

      // sutil re‑animación
      content.classList.remove('fadeInUp');
      media.classList.remove('fadeIn');
      // Forzar reflow para reiniciar animación
      void content.offsetWidth;
      void media.offsetWidth;

      titleEl.textContent = svc.title;
      descEl.textContent = svc.description;

      content.classList.add('fadeInUp');
      media.classList.add('fadeIn');
    }

    tabs.forEach(tab => {
      tab.addEventListener('click', () => {
        setActive(tab.getAttribute('data-tab'));
      });
    });

    // Scroll animations
    const observerOptions = {
      threshold: 0.1,
      rootMargin: '0px 0px -50px 0px'
    };

    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('animate');
        }
      });
    }, observerOptions);

    // Observar elementos para animar
    const header = document.querySelector('.servicios-tabs-section .servicios-tabs-header');
    const tabsEl = document.querySelector('.servicios-tabs-section .tabs');
    const panel = document.querySelector('.servicios-tabs-section .panel');

    if (header) observer.observe(header);
    if (tabsEl) observer.observe(tabsEl);
    if (panel) observer.observe(panel);
  </script>
</section>


